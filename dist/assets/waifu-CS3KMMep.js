import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */const k="https://api.waifu.im/search",p=document.getElementById("tags"),v=document.getElementById("orientation"),I=document.getElementById("nsfw"),w=document.getElementById("searchBtn"),x=document.getElementById("nextBtn"),m=document.getElementById("gallery"),r=document.getElementById("loading"),u=document.getElementById("error"),g=document.getElementById("imageModal"),M=document.getElementById("modalImage"),S=document.getElementById("modalTags"),T=document.getElementById("modalSource"),$=document.querySelector(".close"),B=document.getElementById("tagsLabel"),f=document.getElementById("tagCloud");B.addEventListener("mouseenter",()=>{f.classList.remove("hidden")});document.addEventListener("mouseleave",e=>{!B.matches(":hover")&&!f.matches(":hover")&&f.classList.add("hidden")});function N(){const e={},t=p.value.trim();t&&(e.included_tags=t.split(",").map(d=>d.trim()).filter(d=>d));const n=v.value;return n&&(e.orientation=n),e.is_nsfw=I.value,e}async function h(e=!1){try{r.classList.remove("hidden"),u.classList.add("hidden"),e||(m.innerHTML="");const t=N(),n=new URLSearchParams;for(const s in t)Array.isArray(t[s])?t[s].forEach(i=>{n.append(s,i)}):n.set(s,t[s]);const d=`${k}?${n.toString()}`;console.log("Request URL:",d);const a=await fetch(d);if(!a.ok)throw new Error(`Ошибка запроса: ${a.status} ${a.statusText}`);const o=await a.json();if(console.log("Response data:",o),r.classList.add("hidden"),!o.images||o.images.length===0){y("Изображения не найдены. Попробуйте изменить параметры поиска.");return}b(o.images,e)}catch(t){r.classList.add("hidden"),y(t.message),console.error("Ошибка:",t)}}function y(e){u.textContent=`❌ ${e}`,u.classList.remove("hidden")}function b(e,t=!1){t||(m.innerHTML=""),e.forEach((n,d)=>{const a=document.createElement("div");a.className="gallery-item";const o=document.createElement("img");o.src=n.url,o.alt=n.tags.map(l=>l.name).join(", "),o.loading="lazy";const s=document.createElement("div");s.className="image-info";const i=document.createElement("div");i.className="tags",n.tags.slice(0,5).forEach(l=>{const E=document.createElement("span");E.className="tag",E.textContent=l.name,i.appendChild(E)});const c=document.createElement("a");c.href=n.source,c.target="_blank",c.className="source-link",c.textContent="🔗 Открыть источник",c.onclick=l=>l.stopPropagation(),s.appendChild(i),s.appendChild(c),a.appendChild(o),a.appendChild(s),a.addEventListener("click",()=>{q(n)}),m.appendChild(a)})}function q(e){g.classList.remove("hidden"),M.src=e.url;const t=e.tags.map(n=>n.name).join(", ");S.textContent=`Теги: ${t}`,T.href=e.source}function C(){g.classList.add("hidden")}w.addEventListener("click",()=>h(!1));x.addEventListener("click",()=>h(!0));$.addEventListener("click",C);g.addEventListener("click",e=>{e.target===g&&C()});p.addEventListener("keypress",e=>{e.key==="Enter"&&h(!1)});window.addEventListener("DOMContentLoaded",()=>{h(!1)});function L(){m.innerHTML="",u.classList.add("hidden"),r.classList.add("hidden")}p.addEventListener("input",L);v.addEventListener("change",L);I.addEventListener("change",L);
